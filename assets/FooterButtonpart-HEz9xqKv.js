import{a0 as i,r as v,j as e,u as g}from"./index-Duw-MC8m.js";import"./FormContainer-DGeBXD1W.js";import{q as k,C as x}from"./Tag-CMmnTKqX.js";import{m as p,B as b}from"./hoist-non-react-statics.cjs-BwjawDnG.js";import{P as C}from"./Upload-OoFD4reN.js";import"./Select-ep4hNdnq.js";import{t as E,N as A}from"./toast-D2qmmyN5.js";import{e as D}from"./index-CUh-FhuQ.js";const R=async a=>{try{return await i({url:"/form_a_download",method:"get",params:a,responseType:"blob"})}catch(s){throw console.error("Error fetching PDF:",s),s}},O=({handleDownload:a})=>{const[s,r]=v.useState(!1),[l,n]=v.useState(!1),c=async()=>{r(!0),n(!1);try{await a(),n(!0)}catch(d){console.error("Download failed",d)}finally{r(!1),setTimeout(()=>n(!1),2e3)}};return e.jsx("div",{className:"mt-4 flex items-center justify-center",children:e.jsx(p.button,{className:`relative px-4 sm:px-6 py-3 font-semibold text-white rounded-lg shadow-md ${s?"bg-blue-400 cursor-not-allowed":l?"bg-green-500":"bg-white"}`,disabled:s,whileHover:{scale:s?1:1.05},whileTap:{scale:s?1:.95},onClick:c,children:s?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p.span,{className:"flex items-center",animate:{y:[0,10,0]},transition:{repeat:1/0,duration:.6,ease:"easeInOut"},children:e.jsx(D,{className:"h-5 w-5"})}),"Downloading..."]}):l?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p.span,{initial:{scale:0},animate:{scale:1},transition:{duration:.3},children:"âœ…"}),"Download Complete!"]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-6 h-6 text-red-600"}),e.jsx("span",{className:"hidden sm:inline text-black font-bold",children:"Download Appraisal Report"})]})})})},W=async(a,s,r,l,n)=>{try{return await i({url:`/officer/form_c?department_id=${a}&team_id=${s}&year=${r}&staff_id=${n}&quater=${l}`,method:"get"})}catch(c){throw console.error("Error fetching information data:",c),c}},K=async(a,s,r,l)=>{try{return await i({url:`/officer/form_c_comments?department_id=${a}&team_id=${s}&year=${r}&staff_id=${l}`,method:"get"})}catch(n){throw console.error("Error fetching information data:",n),n}},X=async a=>{try{return await i({url:"/officer/form_c_comments",method:"post",data:a})}catch(s){throw console.error("Error fetching information data:",s),s}},T=async a=>{try{return await i({url:"/download",method:"get",params:a,responseType:"blob"})}catch(s){throw console.error("Error fetching PDF:",s),s}},$=async a=>{try{return await i({url:"/form_c_download",method:"get",params:a,responseType:"blob"})}catch(s){throw console.error("Error fetching PDF:",s),s}},L=async a=>{try{return await i({url:"/form_c_download",method:"get",params:a,responseType:"blob"})}catch(s){throw console.error("Error fetching PDF:",s),s}},Z=({department:a,team:s,progress:r,title:l,downloadButton:n,staffID:c,formType:d})=>{const f=(o,t)=>{const u=o.split(" ");return u.slice(0,t).join(" ")+(u.length>t?"...":"")},w=String(d).toUpperCase(),N=g(o=>{var t;return(t=o.auth.user)==null?void 0:t.staff_id}),m=String(g(o=>{var t;return(t=o.auth.user)==null?void 0:t.role})).toUpperCase();console.log("This is form type in header",m),console.log("This staff_id is comming from redux",N);const j=(a==null?void 0:a.department_name)||"N/A",_=(a==null?void 0:a.department_description)||"No description available",y=(s==null?void 0:s.team_name)||"N/A",F=(s==null?void 0:s.team_description)||"No description available",P=g(o=>o.quaterTab.selectedQuarter),S=(r==null?void 0:r[P])??0,I=async()=>{try{const o={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID")||"",year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),staff_id:m==="STAFF"?N:c};console.log("Request data for download:",o);let t;if(console.log("Form type for download:",d),w==="A")t=await R(o);else if(w==="C")if(m==="STAFF")t=await L(o);else if(m==="SUPERVISOR")t=await $(o);else if(m==="OFFICER")t=await T(o);else throw new Error(`Invalid role: ${m}`);else throw new Error(`Invalid form type: ${d}`);if(!(t!=null&&t.data))throw new Error("PDF generation failed");const u=window.URL.createObjectURL(new Blob([t.data])),h=document.createElement("a");h.href=u,h.download=d==="A"?"Form_A_Appraisal_Report.pdf":"Form_C_Appraisal_Report.pdf",document.body.appendChild(h),h.click(),h.remove()}catch(o){console.error(o),E.push(e.jsx(A,{title:"Error",type:"danger",children:"Failed to download the PDF."}),{placement:"top-center"})}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("img",{src:"/img/logo/new-logo education.png",className:"h-12 sm:h-16 w-auto",alt:"Logo"})}),n&&e.jsx(O,{handleDownload:I})]}),e.jsx("h1",{className:"text-xl font-bold text-black mb-4 ml-1.5",children:l}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 lg:gap-4",children:[e.jsx(x,{bordered:!0,className:"mb-4 bg-green-600",children:e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"text-white text-lg font-semibold mb-1",children:"PERFORMANCE APPRAISAL PERIOD"}),e.jsx("span",{className:"text-white text-sm",children:"1st Jan 2025 to 31st Dec 2025"})]}),e.jsx("div",{children:e.jsx(C,{variant:"circle",percent:S,width:80})})]})}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(x,{className:"flex-1 p-4 bg-white shadow-sm rounded-md",children:[e.jsxs("div",{className:"text-sm text-gray-700 mb-2",children:[e.jsx("span",{className:"text-black font-bold mr-2",children:"Team Name:"}),f(y,12)]}),e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"text-black font-bold mr-2",children:"Description:"}),f(F,12)]})]}),e.jsxs(x,{className:"flex-1 p-4 bg-white shadow-sm rounded-md",children:[e.jsxs("div",{className:"text-sm text-gray-700 mb-2",children:[e.jsx("span",{className:"text-black font-bold mr-2",children:"Department Name:"}),f(j,12)]}),e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"text-black font-bold mr-2",children:"Description:"}),f(_,12)]})]})]})})]})]})},M=({employeeDetails:a})=>{const s=[{label:"Surname:",value:a.L_Name},{label:"Firstname:",value:a.F_Name},{label:"Othername:",value:a.M_Name||"N/A"},{label:"Role:",value:a.role},{label:"Email:",value:a.email},{label:"IPPIS No:",value:a.ippis_no},{label:"Phone:",value:a.phone},{label:"Designation",value:a.designation},{label:"Gender",value:a.gender},{label:"Grade Lavel",value:a.grade_level},{label:"Date of Posting to Current Job",value:a.date_of_current_posting},{label:"Date of Posting to MDA",value:a.date_of_MDA_posting},{label:"Date of Last Promotion",value:a.date_of_last_promotion}];return e.jsxs(x,{bordered:!0,className:"h-full flex flex-col",children:[e.jsx("div",{className:"mb-4",children:e.jsx("h6",{className:"text-lg font-semibold text-gray-800",children:"Employee Information"})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 gap-x-6 gap-y-2",children:s.map((r,l)=>e.jsxs("div",{className:"flex group",children:[e.jsx("div",{className:"font-bold text-black mr-2 whitespace-nowrap",children:r.label}),e.jsx("div",{className:"text-gray-900 max-w-[180px] truncate cursor-pointer",title:r.value,children:r.value})]},l))})]})},q=({supervisorDetails:a})=>{const s=[{key:"First Name",value:a.F_Name},{key:"Other Name",value:a.M_Name||"N/A"},{key:"Last Name",value:a.L_Name},{key:"Role",value:a.role},{key:"Email",value:a.email},{key:"IPPIS No",value:a.ippis_no},{key:"Phone",value:a.phone},{key:"Designation",value:a.designation}];return e.jsxs(x,{bordered:!0,className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx("h6",{className:"text-lg font-semibold text-gray-800",children:"Supervisor Information"})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-2",children:s.map((r,l)=>e.jsxs("div",{className:"flex group",children:[e.jsxs("div",{className:"font-bold text-black mr-2 whitespace-nowrap",children:[r.key,":"]}),e.jsx("div",{className:"text-gray-900 sm:full sm:truncate cursor-pointer",title:r.value,children:r.value})]},l))})]})},B=({officerDetails:a})=>{const s=[{label:"Surname:",value:a.L_Name},{label:"Firstname:",value:a.F_Name},{label:"Othername:",value:a.M_Name||"N/A"},{label:"IPPIS No:",value:a.ippis_no},{label:"Role",value:a.role},{label:"Designation:",value:a.role},{label:"Email:",value:a.email},{label:"Phone:",value:a.phone}];return e.jsxs(x,{bordered:!0,className:"mb-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx("h6",{className:"text-lg font-semibold text-gray-800",children:"Counter-Signing Officer's Information"})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-2",children:s.map((r,l)=>e.jsxs("div",{className:"flex group",children:[e.jsx("div",{className:"font-bold text-black mr-2 whitespace-nowrap",children:r.label}),e.jsx("div",{className:"text-gray-900 max-w-[180px] truncate cursor-pointer",title:r.value,children:r.value})]},l))})]})},ee=({staff:a,supervisor:s,officer:r})=>e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"h-[98%]",children:a&&e.jsx(M,{employeeDetails:a})})}),e.jsxs("div",{className:"flex flex-col gap-3 flex-1",children:[s&&e.jsx(q,{supervisorDetails:s}),r&&e.jsx(B,{officerDetails:r})]})]}),ae=({next:a,handleNext:s,back:r,handleBack:l,save:n,handleSave:c})=>e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center mt-10 gap-4 sm:gap-0",children:[e.jsx(b,{variant:"solid",className:"w-full sm:w-auto",onClick:l,children:r}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 w-full sm:w-auto",children:[e.jsx(b,{variant:"solid",className:"w-full sm:w-auto",onClick:c,children:n}),e.jsx(b,{variant:"solid",className:"w-full sm:w-auto",onClick:s,children:a})]})]});export{ae as F,Z as H,ee as I,K as O,X as a,W as b};
