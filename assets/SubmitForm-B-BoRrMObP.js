import{aQ as oe,aM as me,j as e,aR as xe,a as W,r as o,u as _,aU as ge,aV as ue,a2 as ne,aW as he,a0 as z,$ as ce,p as be}from"./index-Duw-MC8m.js";import{T as de,b as U,e as pe}from"./Upload-OoFD4reN.js";import{C as je,b as j}from"./Tag-CMmnTKqX.js";/* empty css               */import{B as F,I}from"./hoist-non-react-statics.cjs-BwjawDnG.js";import{ae as Y,af as fe,R as Ne,ag as ye,J as ve}from"./Views-D0EagdUL.js";import"./FormContainer-DGeBXD1W.js";import{S as G}from"./Select-ep4hNdnq.js";import{t as P,N as q}from"./toast-D2qmmyN5.js";import{S as we,h as Se}from"./html2canvas.esm-QUj-fub7.js";import{g as Te}from"./Evidence-D2sau4dz.js";import{F as De,H as Ee,I as Ce}from"./FooterButtonpart-HEz9xqKv.js";import"./index-BbBkhP0Q.js";import"./index-CUh-FhuQ.js";const{TabNav:B,TabList:Oe}=de,Ie=()=>{const r=oe(),s=me(n=>n.quaterTab.selectedQuarter),a=n=>{r(xe(n))};return e.jsx("div",{children:e.jsx(je,{className:"bg-gray-50 card-body-padding mt-8",children:e.jsx(de,{value:s,variant:"pill",onChange:a,children:e.jsxs(Oe,{children:[e.jsx(B,{value:"1",className:`${s==="1"?"bg-green-700 text-white":""}`,children:"First Quarter"}),e.jsx(B,{value:"2",className:`${s==="2"?"bg-green-700 text-white":""}`,children:"Second Quarter"}),e.jsx(B,{value:"3",className:`${s==="3"?"bg-green-700 text-white":""}`,children:"Third Quarter"}),e.jsx(B,{value:"4",className:`${s==="4"?"bg-green-700 text-white":""}`,children:"Fourth Quarter"})]})})})})},{Tr:H,Th:ke,Td:h,THead:Ae,TBody:Me}=j,$e=({employee_task:r})=>{const s=W(),[a,n]=o.useState([]),[c,d]=o.useState({weightSum:0,gradeWeightSum:0,quarterMarksSum:0}),i=_(l=>l.quaterTab.selectedQuarter);return o.useEffect(()=>{const l=(r[i]||[]).map(m=>({selectedKRA:m.kra_name,weight:m.kra_weight,rows:m.objectives.map(t=>({selectedObjective:t.objective_name,gradeWeight:t.gradeed_weight,selectedKPI:t.kpi,unitOfMeasurement:t.unit,targetSet:t.target,targetAchieved:t.target_achieved,raw:t.raw,weighted:t.weighted,score:t.quater_markes}))}));n(l)},[i,r]),o.useEffect(()=>{const l=(r[i]||[]).reduce((x,p)=>x+(p.kra_weight||0),0),m=(r[i]||[]).reduce((x,p)=>x+p.objectives.reduce((b,y)=>b+(y.gradeed_weight||0),0),0),t=(r[i]||[]).reduce((x,p)=>x+p.objectives.reduce((b,y)=>b+(y.quater_markes||0),0),0);d({weightSum:l,gradeWeightSum:m,quarterMarksSum:t}),s(ge(t))},[i,r]),e.jsx("div",{className:"mt-2",children:e.jsxs(j,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(Ae,{children:e.jsx(H,{className:"bg-gray-200",children:["S/N","Key Result Areas","Weight","Objective","Grade Weight","KPIs","Unit of Measurement","Target Set","Target Achieved","Quater Markes","Raw","Weighted"].map((l,m)=>e.jsx(ke,{className:"border border-gray-400 p-2",children:l},m))})}),e.jsxs(Me,{children:[a.map((l,m)=>l.rows.map((t,x)=>e.jsxs(H,{children:[x===0&&e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"border border-gray-400 text-center",rowSpan:l.rows.length,children:m+1}),e.jsx(h,{className:"border border-gray-400",rowSpan:l.rows.length,children:l.selectedKRA}),e.jsx(h,{className:"border border-gray-400 text-center",rowSpan:l.rows.length,children:l.weight})]}),e.jsx(h,{className:"border border-gray-400 break-all",children:t.selectedObjective}),e.jsx(h,{className:"border border-gray-400 text-center",children:t.gradeWeight}),e.jsx(h,{className:"border border-gray-400",children:t.selectedKPI}),e.jsx(h,{className:"border border-gray-400 text-center",children:t.unitOfMeasurement}),e.jsx(h,{className:"border border-gray-400 text-center",children:t.targetSet}),e.jsx(h,{className:"border border-gray-400 text-center",children:t.targetAchieved}),e.jsx(h,{className:"border border-gray-400 text-center",children:t.score}),e.jsx(h,{className:"border border-gray-400 text-center",children:t.raw}),e.jsx(h,{className:"border border-gray-400 text-center",children:t.weighted})]},`${m}-${x}`))),e.jsxs(H,{className:"font-semibold bg-gray-100",children:[e.jsx(h,{className:"border border-gray-400 text-center",colSpan:2,children:"Total"}),e.jsx(h,{className:"border border-gray-400 text-center",children:Math.round(c.weightSum)}),e.jsx(h,{colSpan:1,className:"border border-gray-400 text-center"}),e.jsx(h,{className:"border border-gray-400 text-center",children:Math.round(c.gradeWeightSum)}),e.jsx(h,{colSpan:4,className:"border border-gray-400 text-center",children:"Total"}),e.jsx(h,{colSpan:3,className:"border border-gray-400 text-center",children:c.quarterMarksSum.toFixed(2)})]})]})]})})},{Tr:K,Th:V,Td:J,THead:Fe,TBody:_e}=j,Re=[{grade:"O",description:"Outstanding - 100%"},{grade:"E",description:"Excellent - 90%"},{grade:"VG",description:"Very Good - 80%"},{grade:"G",description:"Good - 70%"}],Pe=()=>{const[r,s]=o.useState(!1),[a,n]=o.useState(window.innerWidth<=1024);o.useEffect(()=>{const i=()=>{n(window.innerWidth<=1024)};return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]);const c=()=>s(!0),d=()=>s(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 3 : EMPLOYEE'S TASKS (70%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(F,{variant:"twoTone",size:"xs",icon:e.jsx(Y,{}),"aria-label":"View Scoring Criteria Values",onClick:c,children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Scoring Criteria Values"})})})]})}),e.jsx(U,{title:"Scoring Criteria",isOpen:r,placement:"right",width:a?"100%":800,onClose:d,onRequestClose:d,children:e.jsxs(j,{compact:!0,className:"border-collapse border border-gray-300 w-full mt-4",children:[e.jsx(Fe,{children:e.jsxs(K,{className:"bg-gray-100",children:[e.jsx(V,{className:"border border-gray-300 p-2",children:"Grade"}),e.jsx(V,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(_e,{children:Re.map((i,l)=>e.jsxs(K,{children:[e.jsx(J,{className:"border border-gray-300 p-2",children:i.grade}),e.jsx(J,{className:"border border-gray-300 p-2",children:i.description})]},l))})]})})]})},{Tr:X,Th:Z,Td:ee,THead:qe,TBody:Be}=j,He=({isOpen:r,setIsOpen:s})=>{const[a,n]=o.useState(window.innerWidth<=1024);o.useEffect(()=>{const d=()=>{n(window.innerWidth<=1024)};return window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]);const c=[{id:1,title:"Greatly Exceeds Expectations (5)",desc:"Performance far exceeded agreed target(s)..."},{id:2,title:"Exceeds Expectations (4)",desc:"Performance exceeded agreed target(s)..."},{id:3,title:"Meets Expectations (3)",desc:"Performance target(s) achieved..."},{id:4,title:"Occasionally Meets Expectations (2)",desc:"Performance failed to meet expectations..."}];return e.jsx(U,{isOpen:r,title:"Performance Rating Scale",width:a?"100%":750,onClose:()=>s(!1),children:e.jsxs(j,{compact:!0,className:"w-full text-left mt-4 border border-gray-300",children:[e.jsx(qe,{children:e.jsxs(X,{className:"bg-gray-100",children:[e.jsx(Z,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(Z,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(Be,{children:c.map(d=>e.jsxs(X,{children:[e.jsx(ee,{className:"border border-gray-300 p-2",children:d.title}),e.jsx(ee,{className:"border border-gray-300 p-2",children:d.desc})]},d.id))})]})})},Qe=()=>{const[r,s]=o.useState(!1);return e.jsxs("div",{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 4 : COMPETENCIES (20%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(F,{variant:"twoTone",size:"xs",icon:e.jsx(Y,{}),onClick:()=>s(!0),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(He,{isOpen:r,setIsOpen:s})]})},{Tr:Q,Th:O,Td:w,THead:Le,TBody:We}=j,ze=({competencies:r})=>{const s=W(),a=_(l=>l.quaterTab.selectedQuarter),n=r[a],c=n.reduce((l,m)=>l+m.competencies_details.reduce((t,x)=>t+x.max_score,0),0),d=n.reduce((l,m)=>l+m.competencies_details.reduce((t,x)=>t+x.quarter_marks,0),0),i=c>0?d/c*20:0;return s(ue(i)),e.jsx("div",{className:"border overflow-hidden shadow-sm",children:e.jsxs(j,{compact:!0,className:"w-full bg-white",children:[e.jsx(Le,{children:e.jsxs(Q,{className:"bg-gray-200",children:[e.jsx(O,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Competency"}),e.jsx(O,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Cluster"}),e.jsx(O,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Sub Cluster"}),e.jsx(O,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Description"}),e.jsx(O,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Max"}),e.jsx(O,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Min"}),e.jsx(O,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Quater Marks"})]})}),e.jsxs(We,{className:"divide-y divide-gray-200",children:[n.map(l=>e.jsx(ne.Fragment,{children:l.competencies_details.map((m,t)=>e.jsxs(Q,{children:[t===0&&e.jsx(w,{className:"px-4 py-3 align-top font-semibold border border-gray-400",rowSpan:l.competencies_details.length,children:l.competencies}),e.jsx(w,{className:"px-4 py-3 border border-gray-400",children:m.cluster}),e.jsx(w,{className:"px-4 py-3 border border-gray-400",children:m.sub_cluster}),e.jsx(w,{className:"px-4 py-3 border border-gray-400",children:m.describe_expectations}),e.jsx(w,{className:"px-4 py-3 border border-gray-400 w-[8%]",children:m.max_score}),e.jsx(w,{className:"px-4 py-3 border border-gray-400 w-[8%]",children:m.min_score}),e.jsx(w,{className:"px-4 py-3 border border-gray-400 w-[8%]",children:m.quarter_marks})]},t))},l.id)),e.jsxs(Q,{className:"font-semibold bg-gray-100",children:[e.jsx(w,{className:"border border-gray-400 text-center",colSpan:4}),e.jsx(w,{className:"border border-gray-400 text-center",children:"Total"}),e.jsx(w,{colSpan:2,className:"border border-gray-400 text-center",children:i.toFixed(2)})]})]})]})})},{Tr:M,Th:re,Td:D,THead:Ue,TBody:Ye}=j,Ge=()=>{const[r,s]=o.useState(!1),[a,n]=o.useState(window.innerWidth<=1024);o.useEffect(()=>{const i=()=>{n(window.innerWidth<=1024)};return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]);const c=()=>{s(!0)},d=i=>{console.log("onDrawerClose",i),s(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 5 : OPERATIONS AND PROCESSES (10%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(F,{variant:"twoTone",size:"xs",icon:e.jsx(Y,{}),onClick:()=>c(),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(U,{title:"Performance Rating Scale  ",isOpen:r,width:a?"100%":750,onClose:d,onRequestClose:d,children:e.jsxs(j,{compact:!0,className:"table-auto border-collapse border border-gray-300 w-full text-left mt-4",children:[e.jsx(Ue,{children:e.jsxs(M,{className:"bg-gray-100",children:[e.jsx(re,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(re,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsxs(Ye,{children:[e.jsxs(M,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Greatly Exceeds Expectations (5)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance far exceeded agreed target(s) on all critical parameters on a consistent basis; overall quality of work and performance is excellent."})]}),e.jsxs(M,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Exceeds Expectations (4)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance exceeded agreed target(s) on all critical parameters; overall quality of work and performance is very good."})]}),e.jsxs(M,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Meets Expectations (3)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance target(s) achieved on all critical parameters; overall quality of work and performance is good."})]}),e.jsxs(M,{children:[e.jsx(D,{className:"border border-gray-300 p-2",children:"Occasionally Meets Expectations (2)"}),e.jsx(D,{className:"border border-gray-300 p-2",children:"Performance failed to meet expectations on agreed target(s) and on some critical parameters; performance deficiencies can however be addressed with support through guidance, coaching, mentoring and/ or training."})]})]})]})})]})},{Tr:L,Th:$,Td:E,THead:Ke,TBody:Ve}=j,Je=({operation_and_process:r})=>{const s=W(),a=_(l=>l.quaterTab.selectedQuarter),n=r[a]||[],c=n.reduce((l,m)=>l+m.details.reduce((t,x)=>t+x.max_score,0),0),d=n.reduce((l,m)=>l+m.details.reduce((t,x)=>t+x.quarter_marks,0),0),i=c>0?d/c*10:0;return s(he(i)),e.jsxs(j,{compact:!0,className:"table-auto border-collapse border border-gray-400 w-full bg-white",children:[e.jsx(Ke,{children:e.jsxs(L,{className:"bg-gray-200",children:[e.jsx($,{className:"border border-gray-400 p-2",children:"Operations and Processes"}),e.jsx($,{className:"border border-gray-400 p-2",children:"Describe Expectations"}),e.jsx($,{className:"border border-gray-400 p-2 text-center",children:"Min Score"}),e.jsx($,{className:"border border-gray-400 p-2 text-center",children:"Max Score"}),e.jsx($,{className:"border border-gray-400 p-2 text-center",children:"Quarter Marks"})]})}),e.jsxs(Ve,{children:[n.map((l,m)=>e.jsx(ne.Fragment,{children:l.details.map((t,x)=>e.jsxs(L,{children:[x===0&&e.jsx(E,{className:"border border-gray-400 p-2 font-bold",rowSpan:l.details.length,children:l.operations_and_process}),e.jsx(E,{className:"border border-gray-400 p-2",children:t.describe_expectations}),e.jsx(E,{className:"border border-gray-400 p-2 text-center",children:t.min_score}),e.jsx(E,{className:"border border-gray-400 p-2 text-center",children:t.max_score}),e.jsx(E,{className:"border border-gray-400 p-2 text-center",children:t.quarter_marks})]},x))},m)),e.jsxs(L,{className:"font-semibold bg-gray-100",children:[e.jsx(E,{className:"border border-gray-400 text-center",colSpan:2}),e.jsx(E,{className:"border border-gray-400 text-center",children:"Total"}),e.jsx(E,{colSpan:2,className:"border border-gray-400 text-center",children:i.toFixed(2)})]})]})]})},{Tr:se,Th:ae,Td:te,THead:Xe,TBody:Ze}=j,er=()=>{const{quarterMarksSum:r,competencyMarks:s,oprationMarks:a}=_(d=>d.assesment),n=r+s+a,c=[{label:"Sub-total rating of appraisee performance (Expectations and Goals from Section 3)",value:r.toFixed(3)},{label:"Sub-total rating of appraisee performance (Competencies) in Section 4",value:s.toFixed(3)},{label:"Sub-total rating of appraisee performance (Operations and Processes) in Section 5",value:a.toFixed(3)},{label:"Overall Rating (Section 3 + 4 + 5)",value:n.toFixed(3)}];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 6: Summary of Overall Assessment (10%)"})}),e.jsxs(j,{compact:!0,className:"table-auto border-collapse border border-gray-300 w-full text-left bg-white",children:[e.jsx(Xe,{children:e.jsxs(se,{className:"bg-gray-100",children:[e.jsx(ae,{className:"border border-gray-300 p-2",children:"Overall Assessment"}),e.jsx(ae,{className:"border border-gray-300 p-2 text-center",children:"Appraiser Rating"})]})}),e.jsx(Ze,{children:c.map((d,i)=>e.jsxs(se,{children:[e.jsx(te,{className:"border border-gray-300 p-2",children:d.label}),e.jsx(te,{className:"border border-gray-300 p-2 text-center",children:d.value??"-"})]},i))})]})]})},rr=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 6 : CONFIRMATION AND ACKNOWLEDGEMENTS"})})})}),sr=({comments:r,onOfficerCommentChange:s,showValidationError:a,commentInputRef:n})=>{var l,m;const[c,d]=o.useState("");o.useEffect(()=>{var x;const t=((x=r.officer)==null?void 0:x.comment)||"";d(t),s(t)},[(l=r.officer)==null?void 0:l.comment,s]);const i=t=>{const x=t.target.value;d(x),s(x)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraisee's Comments:"}),e.jsx(I,{disabled:!0,textArea:!0,value:((m=r.supervisor)==null?void 0:m.comment)||"",className:"input-textarea mt-2"})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraiser's Comments:"}),e.jsx(I,{disabled:!0,textArea:!0,value:r.supervisor.comment||"",className:"input-textarea mt-2"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Comments:"}),e.jsx(I,{required:!0,ref:n,textArea:!0,value:c,placeholder:"Enter your comments here",className:`textarea mt-2 w-full rounded-md border px-3 py-2 focus:outline-none ${a&&!c?"border-red-500":"border-gray-300"}`,onChange:i}),a&&!c&&e.jsxs("div",{className:"flex items-center text-red-500 mt-1",children:[e.jsx(fe,{className:"mr-1"}),"This field is required."]})]})]})},ar=({Supervisor:r})=>{const s=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],a=s.find(n=>n.value===(r==null?void 0:r.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Appraisee's Declaration :"}),e.jsx(G,{isDisabled:!0,id:"declaration",value:a,options:s,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(I,{disabled:!0,id:"date",value:(r==null?void 0:r.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Appraisee's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Appraisee's"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:r!=null&&r.signature?e.jsx("img",{src:r.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},tr=({staff:r})=>{const s=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],a=s.find(n=>n.value===(r==null?void 0:r.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Appraiser's Declaration:"}),e.jsx(G,{isDisabled:!0,id:"declaration",value:a,options:s,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(I,{disabled:!0,id:"date",value:(r==null?void 0:r.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Appraiser's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Appraiser"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:r!=null&&r.signature?e.jsx("img",{src:r.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},le=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],lr=({officer:r,onChange:s})=>{const[a,n]=o.useState(null),[c,d]=o.useState(null),[i,l]=o.useState(null),[m,t]=o.useState(null),[x,p]=o.useState(!1),[b,y]=o.useState(0),k=o.useRef(null),v=o.useRef(null),C=o.useRef(null);o.useEffect(()=>{r&&(n(r.declaration),l(r.signature),d(r.date?new Date(r.date):null),y((r.signature,0)))},[r]);const A=g=>{var S;const u=(S=g.target.files)==null?void 0:S[0];if(u){if(u.size>70*1024){alert("File size exceeds 70Kb. Please upload a smaller file.");return}if(!u.type.startsWith("image/")){alert("Invalid file type. Please upload an image.");return}const T=new FileReader;T.onloadend=()=>{const ie=T.result;l(ie),t(u.name),y(1)},T.readAsDataURL(u)}},R=()=>{p(!0)},f=async()=>{if(v.current&&!v.current.isEmpty()){if(C.current){const u=(await Se(C.current)).toDataURL("image/png");l(u),y(1),p(!1)}}else alert("Please draw a signature before saving.")},N=()=>{var g;(g=v.current)==null||g.clear()};return o.useEffect(()=>{const g=c!==null?new Date(c.getFullYear(),c.getMonth(),c.getDate()+1):null,u={declaration:a,date:g,flag:b};b===1&&(u.signature=i),s(u)},[a,c,i,b]),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4 items-start mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Declaration:"}),e.jsx(G,{placeholder:"Please Select",options:le,className:"mt-2",value:le.find(g=>g.value===a),onChange:g=>n((g==null?void 0:g.value)??null)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(pe,{className:"mt-2",value:c,onChange:g=>d(g)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Signature:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",className:"flex items-center gap-2 focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2",onClick:R,children:[e.jsx(Ne,{className:"w-5 h-5"}),"Add Signature"]}),e.jsxs("button",{type:"button",className:"flex items-center gap-2 focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2",onClick:()=>{var g;return(g=k.current)==null?void 0:g.click()},children:[e.jsx(ye,{className:"w-5 h-5"}),"Upload"]}),e.jsx("input",{ref:k,type:"file",accept:"image/*",className:"hidden",onChange:A})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Uploaded Image:"}),i&&e.jsx("div",{className:"border border-gray-400 p-2 rounded-md mt-2 w-50 h-44 flex items-center justify-center",children:e.jsx("img",{src:i,alt:"Uploaded Preview",className:"h-full w-full object-fill rounded-md"})})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Draw Your Signature"}),e.jsx("button",{onClick:()=>p(!1),children:e.jsx(ve,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("div",{ref:C,className:" rounded-md mt-4 bg-white",children:e.jsx(we,{ref:v,canvasProps:{width:330,height:150,className:"sigCanvas"}})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(F,{size:"sm",variant:"default",onClick:N,children:"Clear"}),e.jsx(F,{size:"sm",variant:"solid",onClick:f,children:"Save"})]})]})})]})},nr=({submittedEvidence:r})=>{if(!r||r.length===0)return e.jsx("p",{className:"text-gray-500",children:"No submitted evidence available."});const s=async a=>{try{const c=(await Te(a)).data,d=URL.createObjectURL(c);window.open(d,"_blank")}catch(n){console.error("Error fetching evidence data:",n)}};return e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1.5 block",children:"Submitted Evidence:"}),e.jsx("div",{className:"flex flex-col gap-4",children:r.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-md",children:[e.jsx("span",{className:"text-blue-600 underline max-w-[250px] truncate cursor-pointer",onClick:()=>s(a.evidence_id),children:a.evidence_id}),e.jsx("div",{className:"flex-1 text-right",children:e.jsxs("p",{className:"text-gray-500 text-sm",children:[e.jsx("strong",{children:"Created:"})," ",new Date(a.created_at).toLocaleDateString()]})})]},a.id))})]})},cr=async(r,s,a,n,c)=>{try{return await z({url:`/officer/form_b?department_id=${r}&team_id=${s}&year=${a}&staff_id=${c}&quater=${n}`,method:"get"})}catch(d){throw console.error("Error fetching information data:",d),d}},dr=async(r,s,a,n)=>{try{return await z({url:`/officer/form_b_comments?department_id=${r}&team_id=${s}&year=${a}&staff_id=${n}`,method:"get"})}catch(c){throw console.error("Error fetching information data:",c),c}},ir=async r=>{try{return await z({url:"/officer/form_b_comments",method:"post",data:r})}catch(s){throw console.error("Error fetching information data:",s),s}},or=()=>{const{id:r}=ce(),s=be(),[a,n]=o.useState(null),[c,d]=o.useState(!0),[i,l]=o.useState(null),[m,t]=o.useState(""),[x,p]=o.useState(!1),[b,y]=o.useState({declaration:null,date:null,signature:null,flag:0}),k=async()=>{try{const f=localStorage.getItem("selectedDepartmentID")||"",N=localStorage.getItem("selectedTeamID"),g=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),u=await dr(f,N?Number(N):null,g,String(r));if(u&&u.data)n(u.data);else throw new Error("Invalid response data")}catch(f){console.error("Error fetching data:",f),l("Failed to load data. Please try again.")}finally{d(!1)}};o.useEffect(()=>{k()},[]);const v=o.useRef(null),C=async()=>{var f,N,g;if(!m.trim()){p(!0),(f=v.current)==null||f.scrollIntoView({behavior:"smooth",block:"center"}),P.push(e.jsx(q,{title:"Error",type:"danger",children:"Appraisee's Comments is required"}),{placement:"top-center"});return}p(!1);try{const u=b.date instanceof Date?b.date.toISOString().split("T")[0]:null,S={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),staff_id:r,comment:m,date:u,signature:b.signature,declaration:b.declaration,flag:b.flag};(await ir(S)).status===200?P.push(e.jsx(q,{title:"Success",type:"success",children:"Data submitted successfully!"}),{placement:"top-center"}):P.push(e.jsx(q,{title:"Error",type:"danger",children:"Unexpected response from the server. Please try again."}),{placement:"top-center"})}catch(u){const S=((g=(N=u.response)==null?void 0:N.data)==null?void 0:g.error)||u.message||"An unexpected error occurred.";P.push(e.jsx(q,{title:"Error",type:"danger",children:S}),{placement:"top-center"}),console.error("Error submitting data:",u)}},A=()=>{s(-1)},R=()=>{s(`/form/officer/annual-review/${r}`)};return c?e.jsx("div",{children:"Loading..."}):i?e.jsx("div",{className:"text-red-500",children:i}):a?e.jsxs("div",{className:"mt-4 mx-auto w-full",children:[e.jsx(rr,{}),e.jsxs("div",{className:"bg-white p-4",children:[e.jsx("div",{className:"mt-4",children:e.jsx(nr,{submittedEvidence:a.comments.staff.evidence||[]})}),e.jsx("div",{className:"mt-4",children:e.jsx(sr,{commentInputRef:v,comments:{staff:a.comments.staff||{comment:""},supervisor:a.comments.supervisor||{comment:""},officer:a.comments.officer||{comment:""}},showValidationError:x,onOfficerCommentChange:t})}),e.jsx("div",{className:"mt-4",children:e.jsx(ar,{Supervisor:a.comments.supervisor})}),e.jsx("div",{className:"mt-4",children:e.jsx(tr,{staff:a.comments.staff})}),e.jsx("div",{className:"mt-4",children:e.jsx(lr,{officer:a.comments.officer,onChange:f=>y(f)})})]}),e.jsx(De,{back:"Back",handleBack:A,save:"Save",handleSave:C,next:"Next",handleNext:R})]}):e.jsx("div",{children:"No data available."})},mr=({assesment:r,improvement:s})=>e.jsxs("div",{children:[e.jsx("div",{className:"mt-2",children:e.jsx(I,{disabled:!0,textArea:!0,className:"input-textarea mt-2",value:r||"What are the employee’s strengths?"})}),e.jsx("div",{className:"mt-2",children:e.jsx(I,{disabled:!0,textArea:!0,className:"input-textarea mt-2",value:s||"What are the employee’s areas for improvement?"})})]}),Dr=()=>{const{id:r}=ce(),s=_(N=>N.quaterTab.selectedQuarter),[a,n]=o.useState(null),[c,d]=o.useState(!0),[i,l]=o.useState(null),m=async()=>{try{const N=localStorage.getItem("selectedDepartmentID")||"",g=localStorage.getItem("selectedTeamID"),u=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),S=r,T=await cr(N,g?Number(g):null,u,s,String(S));if(T&&T.data)n(T.data);else throw new Error("Invalid response data")}catch(N){console.error("Error fetching data:",N),l("Failed to load data. Please try again.")}finally{d(!1)}};if(o.useEffect(()=>{m()},[]),c)return e.jsx("div",{children:"Loading..."});if(i)return e.jsx("div",{className:"text-red-500",children:i});const{department:t,team:x,supervisor:p,officer:b,staff:y,progress:k,employee_task:v,competencies:C,operation_and_process:A,overall_assesment:R,others:f}=a||{};return e.jsxs("div",{children:[e.jsx(Ee,{department:t,team:x,progress:k,title:"PERFORMANCE APPRAISAL",downloadButton:!1,staffID:r}),y&&p&&b&&e.jsx(Ce,{staff:y,supervisor:p,officer:b}),e.jsx(Ie,{}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Pe,{}),v&&e.jsx($e,{employee_task:v})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Qe,{}),e.jsx(ze,{competencies:C})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Ge,{}),e.jsx(Je,{operation_and_process:A})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(er,{}),e.jsx(mr,{assesment:f.strengths,improvement:f.improvement})]}),e.jsx(or,{})]})};export{Dr as default};
