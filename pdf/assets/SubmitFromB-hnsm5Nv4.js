import{r as o,j as e,a0 as Y,a as be,$ as W,u as U,aU as Ne,aQ as fe,aV as ve,a2 as je,aW as we,aM as Se,aR as Te,p as Ee}from"./index-DO1rypAV.js";import{F as De,H as _e,I as Ce}from"./FooterButtonpart-CiYkZePb.js";import{B as A,I as O}from"./hoist-non-react-statics.cjs-C6jsoQmo.js";import{b as X,T as ye,e as Ie}from"./Upload-CogA4DrA.js";import{ae as Z,af as ne,R as ke,ag as Fe,J as $e}from"./Views-DTCaAhLq.js";import{b as k,C as Oe,E as Ae,q as Me,x as Pe}from"./Tag-DznXhQT_.js";import"./FormContainer-C1KCoetB.js";import{S as ee}from"./Select-C9Fp3WxF.js";import{t as C,N as I}from"./toast-DSybWTXl.js";import{S as qe,h as Re}from"./html2canvas.esm-B4x8ZHI9.js";import{g as Qe}from"./Evidence-ICuExoy1.js";import"./index-zMKRgny6.js";import"./index-Cc5Ur03J.js";const{Tr:le,Th:ce,Td:oe,THead:Ye,TBody:He}=k,Be=[{grade:"O",description:"Outstanding - 100%"},{grade:"E",description:"Excellent - 90%"},{grade:"VG",description:"Very Good - 80%"},{grade:"G",description:"Good - 70%"}],Le=()=>{const[r,s]=o.useState(!1),[a,c]=o.useState(window.innerWidth<=1024);o.useEffect(()=>{const x=()=>{c(window.innerWidth<=1024)};return window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]);const i=()=>s(!0),d=()=>s(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 3 : EMPLOYEE'S TASKS (70%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(A,{variant:"twoTone",size:"xs",icon:e.jsx(Z,{}),"aria-label":"View Scoring Criteria Values",onClick:i,children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Scoring Criteria Values"})})})]})}),e.jsx(X,{title:"Scoring Criteria",isOpen:r,placement:"right",width:a?"100%":800,onClose:d,onRequestClose:d,children:e.jsxs(k,{compact:!0,className:"border-collapse border border-gray-300 w-full mt-4",children:[e.jsx(Ye,{children:e.jsxs(le,{className:"bg-gray-100",children:[e.jsx(ce,{className:"border border-gray-300 p-2",children:"Grade"}),e.jsx(ce,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(He,{children:Be.map((x,f)=>e.jsxs(le,{children:[e.jsx(oe,{className:"border border-gray-300 p-2",children:x.grade}),e.jsx(oe,{className:"border border-gray-300 p-2",children:x.description})]},f))})]})})]})},We=async(r,s,a,c,i)=>{try{return await Y({url:`/supervisor/form_b?department_id=${r}&team_id=${s}&year=${a}&staff_id=${c}&quater=${i}`,method:"get"})}catch(d){throw console.error("Error fetching information data:",d),d}},ze=async r=>{try{return await Y({url:"supervisor/form_b/employee_task",method:"post",data:r})}catch(s){throw console.error("Error fetching information data:",s),s}},Ue=async r=>{try{return await Y({url:"supervisor/form_b/competencies",method:"post",data:r})}catch(s){throw console.error("Error fetching information data:",s),s}},Ve=async r=>{try{return await Y({url:"supervisor/form_b/operation_and_process",method:"post",data:r})}catch(s){throw console.error("Error fetching information data:",s),s}},Ge=async r=>{try{return await Y({url:"supervisor/form_b/strengths_and_improvement",method:"post",data:r})}catch(s){throw console.error("Error fetching information data:",s),s}},Ke=async r=>{try{return await Y({url:"/supervisor/submit_of_overall_assesment",method:"post",data:r})}catch(s){throw console.error("Error fetching information data:",s),s}},{Tr:se,Th:Je,Td:_,THead:Xe,TBody:Ze}=k,er=({employee_task:r,onSubmitSuccess:s})=>{const a=be(),{id:c}=W(),[i,d]=o.useState([]),[x,f]=o.useState({weightSum:0,gradeWeightSum:0,quarterMarksSum:0}),h=U(p=>p.quaterTab.selectedQuarter),g=localStorage.getItem("selectedDepartmentID")||"",b=Number(localStorage.getItem("selectedTeamID"))||0,N=Number(localStorage.getItem("selectedYear"))||new Date().getFullYear(),T=(p,n,t,l)=>{if(l===""||isNaN(Number(l))){d(j=>j.map((y,w)=>w===p?{...y,rows:y.rows.map((u,v)=>v===n?{...u,[t]:""}:u)}:y));return}const m=parseFloat(l);m>999999||l.includes(".")&&l.split(".")[1].length>6||d(j=>j.map((y,w)=>w===p?{...y,rows:y.rows.map((u,v)=>{var P,q,B,F;if(v!==n)return u;const S=m,D=m+(((F=(B=(q=(P=r[h])==null?void 0:P[p])==null?void 0:q.objectives)==null?void 0:B[n])==null?void 0:F.raw)||0),M=+(u.gradeWeight*D).toFixed(2),H=u.targetSet?+(Number(S)/u.targetSet*u.gradeWeight).toFixed(2):0;return{...u,[t]:m,raw:D,weighted:M,score:H}})}:y))};o.useEffect(()=>{const p=(r[h]||[]).map(n=>({selectedKRA:n.kra_name,weight:n.kra_weight,rows:n.objectives.map(t=>({selectedObjective:t.objective_name,gradeWeight:t.gradeed_weight,selectedKPI:t.kpi,unitOfMeasurement:t.unit,targetSet:t.target,targetAchieved:t.target_achieved,raw:t.raw,weighted:t.weighted,score:t.quater_markes}))}));d(p)},[h,r]),o.useEffect(()=>{const p=i.reduce((l,m)=>l+m.weight,0),n=i.reduce((l,m)=>l+m.rows.reduce((j,y)=>j+y.gradeWeight,0),0),t=i.reduce((l,m)=>l+m.rows.reduce((j,y)=>j+y.score,0),0);f({weightSum:p,gradeWeightSum:n,quarterMarksSum:t}),a(Ne(t))},[i]);const E=async()=>{const p=["1","2","3","4"],n=[];p.forEach(l=>{(r[l]||[]).forEach((j,y)=>{j.objectives.forEach((w,u)=>{var M,H,P;const v=l===h,S=(M=i[y])==null?void 0:M.rows[u];let D=w.raw;if(v)D=(S==null?void 0:S.raw)??w.raw;else{const q=(P=(H=i[y])==null?void 0:H.rows)==null?void 0:P.find(B=>B.selectedKPI===w.kpi);q&&(D=q.raw)}n.push({id:w.id,target_achieved:Number(Number(v?S==null?void 0:S.targetAchieved:w.target_achieved).toFixed(6)),quarter_marks:Number((v?(S==null?void 0:S.score)??0:w.quater_markes).toFixed(2)),raw:Number(D.toFixed(2)),weighted:Number((v?(S==null?void 0:S.weighted)??0:w.gradeed_weight*D).toFixed(2))})})})});const t={staff_id:c,department_id:g,team_id:b,year:N,data:n};try{(await ze(t)).status===200&&(C.push(e.jsx(I,{title:"Success",type:"success",children:"Data saved successfully"}),{placement:"top-center"}),s==null||s())}catch(l){console.error("Error saving data:",l),C.push(e.jsx(I,{title:"Error",type:"danger",children:"Failed to save data. Please try again."}),{placement:"top-center"})}};return e.jsxs("div",{className:"mt-2",children:[e.jsxs(k,{compact:!0,className:"border border-gray-400 w-full bg-white",children:[e.jsx(Xe,{children:e.jsx(se,{className:"bg-gray-200",children:["S/N","Key Result Areas","Weight","Objective","Grade Weight","KPIs","Unit of Measurement","Target Set","Target Achieved",`Quarter Marks (Q${h})`,"Raw","Weighted"].map((p,n)=>e.jsx(Je,{className:"border border-gray-400 p-2",children:p},n))})}),e.jsxs(Ze,{children:[i.map((p,n)=>p.rows.map((t,l)=>e.jsxs(se,{children:[l===0&&e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"border border-gray-400 text-center",rowSpan:p.rows.length,children:n+1}),e.jsx(_,{className:"border border-gray-400",rowSpan:p.rows.length,children:p.selectedKRA}),e.jsx(_,{className:"border border-gray-400 text-center",rowSpan:p.rows.length,children:p.weight})]}),e.jsx(_,{className:"border border-gray-400 break-all",children:t.selectedObjective}),e.jsx(_,{className:"border border-gray-400 text-center",children:t.gradeWeight}),e.jsx(_,{className:"border border-gray-400",children:t.selectedKPI}),e.jsx(_,{className:"border border-gray-400 text-center",children:t.unitOfMeasurement}),e.jsx(_,{className:"border border-gray-400 text-center",children:t.targetSet}),e.jsx(_,{className:"border border-gray-400 text-center",children:e.jsx(O,{type:"number",max:9999,step:1e-6,value:t.targetAchieved===""?"":t.targetAchieved,onChange:m=>T(n,l,"targetAchieved",m.target.value)})}),e.jsx(_,{className:"border border-gray-400 text-center",children:t.score.toFixed(2)}),e.jsx(_,{className:"border border-gray-400 text-center",children:t.raw.toFixed(2)}),e.jsx(_,{className:"border border-gray-400 text-center",children:t.weighted.toFixed(2)})]},`${n}-${l}`))),e.jsxs(se,{className:"font-semibold bg-gray-100",children:[e.jsx(_,{className:"border border-gray-400 text-center",colSpan:2,children:"Total"}),e.jsx(_,{className:"border border-gray-400 text-center",children:Math.round(x.weightSum)}),e.jsx(_,{colSpan:1,className:"border border-gray-400 text-center"}),e.jsx(_,{className:"border border-gray-400 text-center",children:Math.round(x.gradeWeightSum)}),e.jsx(_,{colSpan:4,className:"border border-gray-400 text-center",children:"Total"}),e.jsx(_,{colSpan:3,className:"border border-gray-400 text-center",children:x.quarterMarksSum})]})]})]}),e.jsx("div",{className:"flex flex-col items-end mt-4",children:e.jsx(A,{variant:"solid",color:"green-700",className:"mb-2",onClick:E,children:"Save"})})]})},{Tr:ie,Th:de,Td:me,THead:rr,TBody:sr}=k,tr=({isOpen:r,setIsOpen:s})=>{const[a,c]=o.useState(window.innerWidth<=1024);o.useEffect(()=>{const d=()=>{c(window.innerWidth<=1024)};return window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]);const i=[{id:1,title:"Greatly Exceeds Expectations (5)",desc:"Performance far exceeded agreed target(s)..."},{id:2,title:"Exceeds Expectations (4)",desc:"Performance exceeded agreed target(s)..."},{id:3,title:"Meets Expectations (3)",desc:"Performance target(s) achieved..."},{id:4,title:"Occasionally Meets Expectations (2)",desc:"Performance failed to meet expectations..."}];return e.jsx(X,{isOpen:r,title:"Performance Rating Scale",width:a?"100%":750,onClose:()=>s(!1),children:e.jsxs(k,{compact:!0,className:"w-full text-left mt-4 border border-gray-300",children:[e.jsx(rr,{children:e.jsxs(ie,{className:"bg-gray-100",children:[e.jsx(de,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(de,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsx(sr,{children:i.map(d=>e.jsxs(ie,{children:[e.jsx(me,{className:"border border-gray-300 p-2",children:d.title}),e.jsx(me,{className:"border border-gray-300 p-2",children:d.desc})]},d.id))})]})})},ar=()=>{const[r,s]=o.useState(!1);return e.jsxs("div",{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 4 : COMPETENCIES (20%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(A,{variant:"twoTone",size:"xs",icon:e.jsx(Z,{}),onClick:()=>s(!0),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(tr,{isOpen:r,setIsOpen:s})]})},{Tr:te,Th:L,Td:$,THead:nr,TBody:lr}=k,cr=({competencies:r})=>{const{id:s}=W(),a=fe(),c=U(n=>n.quaterTab.selectedQuarter),[i,d]=o.useState(r),[x,f]=o.useState(i[c]),[h,g]=o.useState({});o.useEffect(()=>{f(i[c])},[c,i]);const b=(n,t,l)=>{if(l<0||l>5){g(m=>({...m,[`${n}-${t}`]:"Value must be between 0 and 5."}));return}g(m=>{const j={...m};return delete j[`${n}-${t}`],j}),d(m=>({...m,[c]:m[c].map(j=>j.id===n?{...j,competencies_details:j.competencies_details.map((y,w)=>w===t?{...y,quarter_marks:l}:y)}:j)}))},N=x.reduce((n,t)=>n+t.competencies_details.reduce((l,m)=>l+m.max_score,0),0),T=x.reduce((n,t)=>n+t.competencies_details.reduce((l,m)=>l+m.quarter_marks,0),0),E=N>0?T/N*20:0;o.useEffect(()=>{a(ve(E))},[E]);const p=async()=>{const n={staff_id:s,department_id:localStorage.getItem("selectedDepartmentID"),team_id:localStorage.getItem("selectedTeamID"),year:new Date().getFullYear(),quater:parseInt(c),competencies_details:i[c].flatMap(t=>t.competencies_details.map(l=>({id:l.id,quarter_marks:l.quarter_marks})))};try{(await Ue(n)).status===200&&C.push(e.jsx(I,{title:"Success",type:"success",children:"Saved Successfully"}))}catch{C.push(e.jsx(I,{title:"Error",type:"danger",children:"Failed to save"}))}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border overflow-hidden shadow-sm",children:e.jsxs(k,{compact:!0,className:"w-full bg-white",children:[e.jsx(nr,{children:e.jsxs(te,{className:"bg-gray-200",children:[e.jsx(L,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Competency"}),e.jsx(L,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Cluster"}),e.jsx(L,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Sub Cluster"}),e.jsx(L,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400",children:"Description"}),e.jsx(L,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Min"}),e.jsx(L,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:"Max"}),e.jsx(L,{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 border border-gray-400 w-[8%]",children:`Quarter Marks (Q${c})`})]})}),e.jsxs(lr,{className:"divide-y divide-gray-200",children:[x.map(n=>e.jsx(je.Fragment,{children:n.competencies_details.map((t,l)=>e.jsxs(te,{children:[l===0&&e.jsx($,{className:"px-4 py-3 align-top font-semibold border border-gray-400",rowSpan:n.competencies_details.length,children:n.competencies}),e.jsx($,{className:"px-4 py-3 border border-gray-400",children:t.cluster}),e.jsx($,{className:"px-4 py-3 border border-gray-400",children:t.sub_cluster}),e.jsx($,{className:"px-4 py-3 border border-gray-400",children:t.describe_expectations}),e.jsx($,{className:"px-4 py-3 border border-gray-400 w-[8%]",children:t.min_score}),e.jsx($,{className:"px-4 py-3 border border-gray-400 w-[8%]",children:t.max_score}),e.jsxs($,{className:"px-4 py-3 border border-gray-400 w-[12%]",children:[e.jsx(O,{size:"sm",value:t.quarter_marks,onChange:m=>b(n.id,l,Number(m.target.value))}),h[`${n.id}-${l}`]&&e.jsx("span",{className:"text-red-500 text-sm",children:h[`${n.id}-${l}`]})]})]},l))},n.id)),e.jsxs(te,{className:"font-semibold bg-gray-100",children:[e.jsx($,{className:"border border-gray-400 text-center",colSpan:4}),e.jsx($,{className:"border border-gray-400 text-center",children:"Total"}),e.jsx($,{colSpan:2,className:"border border-gray-400 text-center",children:E.toFixed(2)})]})]})]})}),e.jsx("div",{className:"text-right mt-4",children:e.jsx(A,{variant:"solid",color:"green-700",onClick:p,children:"Save"})})]})},{Tr:V,Th:ue,Td:R,THead:or,TBody:ir}=k,dr=()=>{const[r,s]=o.useState(!1),[a,c]=o.useState(window.innerWidth<=1024);o.useEffect(()=>{const x=()=>{c(window.innerWidth<=1024)};return window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]);const i=()=>{s(!0)},d=x=>{console.log("onDrawerClose",x),s(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 5 : OPERATIONS AND PROCESSES (10%)"}),e.jsx("div",{className:"flex space-x-2 ml-auto",children:e.jsx(A,{variant:"twoTone",size:"xs",icon:e.jsx(Z,{}),onClick:()=>i(),children:e.jsx("span",{className:"hidden sm:block text-gray-600",children:"Rating"})})})]})}),e.jsx(X,{title:"Performance Rating Scale  ",isOpen:r,width:a?"100%":750,onClose:d,onRequestClose:d,children:e.jsxs(k,{compact:!0,className:"table-auto border-collapse border border-gray-300 w-full text-left mt-4",children:[e.jsx(or,{children:e.jsxs(V,{className:"bg-gray-100",children:[e.jsx(ue,{className:"border border-gray-300 p-2",children:"Title"}),e.jsx(ue,{className:"border border-gray-300 p-2",children:"Description"})]})}),e.jsxs(ir,{children:[e.jsxs(V,{children:[e.jsx(R,{className:"border border-gray-300 p-2",children:"Greatly Exceeds Expectations (5)"}),e.jsx(R,{className:"border border-gray-300 p-2",children:"Performance far exceeded agreed target(s) on all critical parameters on a consistent basis; overall quality of work and performance is excellent."})]}),e.jsxs(V,{children:[e.jsx(R,{className:"border border-gray-300 p-2",children:"Exceeds Expectations (4)"}),e.jsx(R,{className:"border border-gray-300 p-2",children:"Performance exceeded agreed target(s) on all critical parameters; overall quality of work and performance is very good."})]}),e.jsxs(V,{children:[e.jsx(R,{className:"border border-gray-300 p-2",children:"Meets Expectations (3)"}),e.jsx(R,{className:"border border-gray-300 p-2",children:"Performance target(s) achieved on all critical parameters; overall quality of work and performance is good."})]}),e.jsxs(V,{children:[e.jsx(R,{className:"border border-gray-300 p-2",children:"Occasionally Meets Expectations (2)"}),e.jsx(R,{className:"border border-gray-300 p-2",children:"Performance failed to meet expectations on agreed target(s) and on some critical parameters; performance deficiencies can however be addressed with support through guidance, coaching, mentoring and/ or training."})]})]})]})})]})},{Tr:ae,Th:G,Td:Q,THead:mr,TBody:ur}=k,xr=({operation_and_process:r})=>{const{id:s}=W(),a=be(),c=U(n=>n.quaterTab.selectedQuarter),[i,d]=o.useState(r[c]||[]);o.useEffect(()=>{d(r[c]||[])},[c,r]);const[x,f]=o.useState({}),h=()=>i.reduce((n,t)=>n+t.details.reduce((l,m)=>l+m.max_score,0),0),g=()=>i.reduce((n,t)=>n+t.details.reduce((l,m)=>l+m.quarter_marks,0),0),b=h(),N=g(),T=b>0?N/b*10:0;a(we(T));const E=(n,t,l)=>{const m=`${n}-${t}`;if(l<0||l>5){f(y=>({...y,[m]:"value must be between 0 and 5."}));return}f(y=>{const{[m]:w,...u}=y;return u});const j=[...i];j[n].details[t].quarter_marks=l,d(j)},p=async()=>{const n={staff_id:s,department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),quater:parseInt(c,10),operations_and_process:i.flatMap(t=>t.details.map(l=>({id:l.id,quarter_marks:l.quarter_marks})))};try{(await Ve(n)).status===200&&C.push(e.jsx(I,{title:"Success",type:"success",children:"Data saves Successfully"}),{placement:"top-center"})}catch(t){console.error("Error saving data:",t),C.push(e.jsx(I,{title:"Error",type:"danger",children:"Failed to save data. Please try again."}),{placement:"top-center"})}};return e.jsxs(e.Fragment,{children:[e.jsxs(k,{compact:!0,className:"table-auto border-collapse border border-gray-400 w-full bg-white",children:[e.jsx(mr,{children:e.jsxs(ae,{className:"bg-gray-200",children:[e.jsx(G,{className:"border border-gray-400 p-2",children:"Operations and Processes"}),e.jsx(G,{className:"border border-gray-400 p-2",children:"Describe Expectations"}),e.jsx(G,{className:"border border-gray-400 p-2 text-center",children:"Min Score"}),e.jsx(G,{className:"border border-gray-400 p-2 text-center",children:"Max Score"}),e.jsx(G,{className:"border border-gray-400 p-2 text-center",children:`Quarter Marks (Q${c})`})]})}),e.jsxs(ur,{children:[i.map((n,t)=>e.jsx(je.Fragment,{children:n.details.map((l,m)=>{const j=`${t}-${m}`;return e.jsxs(ae,{children:[m===0&&e.jsx(Q,{className:"border border-gray-400 p-2 font-bold",rowSpan:n.details.length,children:n.operations_and_process}),e.jsx(Q,{className:"border border-gray-400 p-2",children:l.describe_expectations}),e.jsx(Q,{className:"border border-gray-400 p-2 text-center",children:l.min_score}),e.jsx(Q,{className:"border border-gray-400 p-2 text-center",children:l.max_score}),e.jsxs(Q,{className:"border border-gray-400 p-2 text-center w-[12%]",children:[e.jsx(O,{size:"sm",value:l.quarter_marks,onChange:y=>E(t,m,Number(y.target.value))}),x[j]&&e.jsx("span",{className:"text-red-500 text-sm",children:x[j]})]})]},m)})},t)),e.jsxs(ae,{className:"font-semibold bg-gray-100",children:[e.jsx(Q,{className:"border border-gray-400 text-center",colSpan:2}),e.jsx(Q,{className:"border border-gray-400 text-center",children:"Total"}),e.jsx(Q,{colSpan:2,className:"border border-gray-400 text-center",children:T.toFixed(2)})]})]})]}),e.jsx("div",{className:"text-right mt-4",children:e.jsx(A,{variant:"solid",color:"green-700",onClick:p,children:"Save"})})]})},{Tr:xe,Th:ge,Td:he,THead:gr,TBody:hr}=k,pr=()=>{const{id:r}=W(),s=U(h=>h.quaterTab.selectedQuarter),{quarterMarksSum:a,competencyMarks:c,oprationMarks:i}=U(h=>h.assesment),d=a+c+i,x=[{label:"Sub-total rating of appraisee performance (Expectations and Goals from Section 3)",value:a.toFixed(3)},{label:"Sub-total rating of appraisee performance (Competencies) in Section 4",value:c.toFixed(3)},{label:"Sub-total rating of appraisee performance (Operations and Processes) in Section 5",value:i.toFixed(3)},{label:"Overall Rating (Section 3 + 4 + 5)",value:d.toFixed(3)}],f=async()=>{var g,b;const h={staff_id:String(r),department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),quater:s,sub_total_rating_expectations:a,sub_total_rating_competencies:c,sub_total_rating_operations:i,overall_rating:d};try{(await Ke(h)).status===200?C.push(e.jsx(I,{title:"Success",type:"success",children:"Data submitted successfully!"}),{placement:"top-center"}):C.push(e.jsx(I,{title:"Error",type:"danger",children:"Unexpected response from the server. Please try again."}),{placement:"top-center"})}catch(N){const T=((b=(g=N.response)==null?void 0:g.data)==null?void 0:b.error)||N.message||"An unexpected error occurred.";C.push(e.jsx(I,{title:"Error",type:"danger",children:T}),{placement:"top-center"})}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"Section 6: Summary of Overall Assessment (10%)"})}),e.jsxs(k,{compact:!0,className:"table-auto border-collapse border border-gray-300 w-full text-left bg-white",children:[e.jsx(gr,{children:e.jsxs(xe,{className:"bg-gray-100",children:[e.jsx(ge,{className:"border border-gray-300 p-2",children:"Overall Assessment"}),e.jsx(ge,{className:"border border-gray-300 p-2 text-center",children:"Appraiser Rating"})]})}),e.jsx(hr,{children:x.map((h,g)=>e.jsxs(xe,{children:[e.jsx(he,{className:"border border-gray-300 p-2",children:h.label}),e.jsx(he,{className:"border border-gray-300 p-2 text-center",children:h.value??"-"})]},g))})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(A,{variant:"solid",color:"green-700",onClick:f,children:"Submit Assessment Point"})})]})},br=()=>{const{id:r}=W(),[s,a]=o.useState(""),[c,i]=o.useState(""),[d,x]=o.useState(null),[f,h]=o.useState(null),g=async()=>{var T,E,p,n;let b=!1;if(s.trim()?x(null):(x("The strengths field is required."),b=!0),c.trim()?h(null):(h("The improvement field is required."),b=!0),b)return;const N={staff_id:r,department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),strengths:s,improvement:c};try{(await Ge(N)).status===200&&C.push(e.jsx(I,{title:"Success",type:"success",children:"Data saved successfully"}),{placement:"top-center"})}catch(t){const l=(E=(T=t.response)==null?void 0:T.data)==null?void 0:E.errors,m=l?Object.values(l).flat().join(`
`):((n=(p=t.response)==null?void 0:p.data)==null?void 0:n.error)||t.message||"An unexpected error occurred.";C.push(e.jsx(I,{title:"Error",type:"danger",children:m}),{placement:"top-center"}),console.error("Error submitting data:",t)}};return e.jsxs("div",{className:"mt-4 mx-auto bg-white shadow-lg rounded-lg p-6 border border-gray-200",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"Employee Strengths and Improvement Areas"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"What are the employee’s strengths?"}),e.jsx(O,{textArea:!0,className:`input-textarea w-full px-4 py-2 border rounded-md ${d?"border-red-500":"border-gray-300"}`,value:s,placeholder:"Describe the employee’s strengths...",onChange:b=>{a(b.target.value),d&&b.target.value.trim()&&x(null)}}),d&&e.jsxs("div",{className:"flex items-center text-red-500 mt-1",children:[e.jsx(ne,{className:"mr-2"}),d]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"What are the employee’s areas for improvement?"}),e.jsx(O,{textArea:!0,className:`input-textarea w-full px-4 py-2 border rounded-md ${f?"border-red-500":"border-gray-300"}`,value:c,placeholder:"Describe the employee’s areas for improvement...",onChange:b=>{i(b.target.value),f&&b.target.value.trim()&&h(null)}}),f&&e.jsxs("div",{className:"flex items-center text-red-500 mt-1",children:[e.jsx(ne,{className:"mr-2"}),f]})]}),e.jsx("div",{className:"text-right mt-6",children:e.jsx(A,{variant:"solid",color:"green-700",className:"bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 transition duration-200",onClick:g,children:"Confirm & Save"})})]})},{TabNav:J,TabList:fr}=ye,jr=()=>{const r=fe(),s=Se(c=>c.quaterTab.selectedQuarter),a=c=>{r(Te(c))};return e.jsx("div",{children:e.jsx(Oe,{className:"bg-gray-50 card-body-padding mt-8",children:e.jsx(ye,{value:s,variant:"pill",onChange:a,children:e.jsxs(fr,{children:[e.jsx(J,{value:"1",className:`${s==="1"?"bg-green-700 text-white":""}`,children:"First Quarter"}),e.jsx(J,{value:"2",className:`${s==="2"?"bg-green-700 text-white":""}`,children:"Second Quarter"}),e.jsx(J,{value:"3",className:`${s==="3"?"bg-green-700 text-white":""}`,children:"Third Quarter"}),e.jsx(J,{value:"4",className:`${s==="4"?"bg-green-700 text-white":""}`,children:"Fourth Quarter"})]})})})})},yr=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"rounded-md text-base text-white bg-green-700 p-2 w-full mb-2",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{className:"text-sm tracking-wide font-semibold",children:"SECTION 6 : CONFIRMATION AND ACKNOWLEDGEMENTS"})})})}),Nr=({evidenceList:r=[],onChange:s})=>{const[a,c]=o.useState(!1),[i,d]=o.useState([]),x=Array.isArray(r)?r.map(g=>({label:g.name,value:g.evidence_id})):[],f=g=>{i.some(N=>N.value===g.evidence_id)||d(N=>[...N,{label:g.name,value:g.evidence_id}]),c(!1)},h=g=>{var N;const b=((N=g.split(".").pop())==null?void 0:N.toLowerCase())||"";return["jpg","jpeg","png","gif"].includes(b)?e.jsx(Ae,{className:"w-8 h-8 text-blue-600"}):b==="pdf"?e.jsx(Me,{className:"w-8 h-8 text-red-600"}):["xls","xlsx"].includes(b)?e.jsx(Pe,{className:"w-8 h-8 text-green-600"}):e.jsx("span",{className:"text-gray-400 text-sm",children:"N/A"})};return o.useEffect(()=>{const g=i.map(b=>b.value);s(g)},[i,s]),e.jsxs("div",{className:"w-full sm:w-1/2 mb-4",children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1.5 block",children:"Evidence Information:"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[e.jsx(ee,{isMulti:!0,placeholder:"Please Select",className:"w-full flex-1",options:x,value:i,onChange:d}),e.jsx(Z,{className:"w-6 h-6 text-gray-500 hover:text-gray-700 cursor-pointer mt-1 sm:mt-0",onClick:()=>c(!0)}),e.jsx(X,{title:"Evidence Details",isOpen:a,width:500,onClose:()=>c(!1),onRequestClose:()=>c(!1),children:e.jsx("div",{className:"space-y-4 p-4 max-w-full",children:Array.isArray(r)&&r.map(g=>e.jsxs("div",{className:"p-4 border rounded-lg bg-gray-100 border-blue-500 flex flex-col sm:flex-row justify-between items-start sm:items-center cursor-pointer hover:bg-blue-50",onClick:()=>f(g),children:[e.jsxs("div",{className:"space-y-1 w-full sm:w-3/4",children:[e.jsx("h4",{className:"font-semibold text-lg",children:g.name}),e.jsx("p",{className:"text-gray-600 text-sm",children:g.description}),e.jsx("a",{href:g.file_path,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline mt-2 block text-sm font-bold",children:"View File"})]}),e.jsx("div",{className:"mt-4 sm:mt-0 sm:ml-4",children:h(g.file_path)})]},g.id))})})]})]})},vr=({comments:r,onAppraisersCommentChange:s,showValidationError:a,commentInputRef:c})=>{var f;const[i,d]=o.useState("");o.useEffect(()=>{const h=r.staff.comment||"";d(h),s(h)},[r.staff.comment]);const x=h=>{const g=h.target.value;d(g),s(g)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraisee's Comments:"}),e.jsx(O,{textArea:!0,disabled:!0,className:"input-textarea mt-2",value:r.staff.comment||""})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraiser's Comments:"}),e.jsx(O,{required:!0,ref:c,textArea:!0,value:i,placeholder:"Enter your comments here",className:`textarea mt-2 w-full rounded-md border px-3 py-2 focus:outline-none ${a&&!i?"border-red-500":"border-gray-300"}`,onChange:x}),a&&!i&&e.jsxs("div",{className:"flex items-center text-red-500 mt-1",children:[e.jsx(ne,{className:"mr-1"}),"This field is required."]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Countersigning Officer's Comments:"}),e.jsx(O,{disabled:!0,textArea:!0,value:((f=r.officer)==null?void 0:f.comment)||"",className:"input-textarea mt-2"})]})]})},wr=({Staff:r})=>{const s=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],a=s.find(c=>c.value===(r==null?void 0:r.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Appraisee's Declaration:"}),e.jsx(ee,{isDisabled:!0,id:"declaration",value:a,options:s,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(O,{disabled:!0,id:"date",value:(r==null?void 0:r.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Appraisee's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Appraisee"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:r!=null&&r.signature?e.jsx("img",{src:r.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},pe=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],Sr=({Supervisor:r,onChange:s,officerDeclaration:a})=>{const[c,i]=o.useState(null),[d,x]=o.useState(null),[f,h]=o.useState(null),[g,b]=o.useState(null),[N,T]=o.useState(!1),[E,p]=o.useState(0),n=o.useRef(null),t=o.useRef(null),l=o.useRef(null);o.useEffect(()=>{r&&(i(r.declaration),h(r.signature),x(r.date?new Date(r.date):null),p((r.signature,0)))},[r]);const m=u=>{var S;const v=(S=u.target.files)==null?void 0:S[0];if(v){if(v.size>70*1024){alert("File size exceeds 70Kb. Please upload a smaller file.");return}if(!v.type.startsWith("image/")){alert("Invalid file type. Please upload an image.");return}const D=new FileReader;D.onloadend=()=>{const M=D.result;h(M),b(v.name),p(1)},D.readAsDataURL(v)}},j=()=>{T(!0)},y=async()=>{if(t.current&&!t.current.isEmpty()){if(l.current){const v=(await Re(l.current)).toDataURL("image/png");h(v),p(1),T(!1)}}else alert("Please draw a signature before saving.")},w=()=>{var u;(u=t.current)==null||u.clear()};return o.useEffect(()=>{const u=d!==null?new Date(d.getFullYear(),d.getMonth(),d.getDate()+1):null,v={declaration:c,date:u,flag:E};E===1&&(v.signature=f),s(v)},[c,d,f,E]),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4 items-start mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Appraiser's Declaration:"}),e.jsx(ee,{isDisabled:a===1,placeholder:"Please Select",options:pe,className:"mt-2",value:pe.find(u=>u.value===c),onChange:u=>i((u==null?void 0:u.value)??null)})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(Ie,{disabled:a===1,className:"mt-2",value:d,onChange:u=>x(u)})]}),e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1",children:"Appraiser's Signature:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",disabled:a===1,className:`flex items-center gap-2 focus:outline-none text-white font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2
                ${a===1?"bg-gray-400 cursor-not-allowed":"bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300"}`,onClick:j,children:[e.jsx(ke,{className:"w-5 h-5"}),"Add Signature"]}),e.jsxs("button",{type:"button",disabled:a===1,className:`flex items-center gap-2 focus:outline-none text-white font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2
                ${a===1?"bg-gray-400 cursor-not-allowed":"bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300"}`,onClick:()=>{var u;return(u=n.current)==null?void 0:u.click()},children:[e.jsx(Fe,{className:"w-5 h-5"}),"Upload"]}),e.jsx("input",{ref:n,type:"file",accept:"image/*",className:"hidden",onChange:m})]})]})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-800 font-semibold",children:"Uploaded Image:"}),f&&e.jsx("div",{className:"border border-gray-400 p-2 rounded-md mt-2 w-50 h-44 flex items-center justify-center",children:e.jsx("img",{src:f,alt:"Uploaded Preview",className:"h-full w-full object-fill rounded-md"})})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Draw Your Signature"}),e.jsx("button",{onClick:()=>T(!1),children:e.jsx($e,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("div",{ref:l,className:" rounded-md mt-4 bg-white",children:e.jsx(qe,{ref:t,canvasProps:{width:330,height:150,className:"sigCanvas "}})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(A,{size:"sm",variant:"default",onClick:w,children:"Clear"}),e.jsx(A,{size:"sm",variant:"solid",onClick:y,children:"Save"})]})]})})]})},Tr=({officer:r})=>{const s=[{value:1,label:"Agree"},{value:0,label:"Disagree"}],a=s.find(c=>c.value===(r==null?void 0:r.declaration));return e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-gray-400 h-0.5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col order-1",children:[e.jsx("label",{htmlFor:"declaration",className:"text-gray-800 font-semibold",children:"Countersigning Officer's Declaration:"}),e.jsx(ee,{isDisabled:!0,id:"declaration",value:a,options:s,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-col order-2",children:[e.jsx("label",{htmlFor:"date",className:"text-gray-800 font-semibold",children:"Date:"}),e.jsx(O,{disabled:!0,id:"date",value:(r==null?void 0:r.date)||"",className:"mt-2"})]}),e.jsx("div",{className:"order-3",children:e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold",children:"Countersigning Officer's Signature:"})}),e.jsxs("div",{className:"flex flex-col order-4",children:[e.jsx("label",{htmlFor:"signature",className:"text-gray-800 font-semibold underline",children:"Signatured by Countersigning Officer's"}),e.jsx("div",{id:"signature",className:"border border-gray-300 p-2 rounded-md mt-2 w-full h-35 flex items-center justify-center",children:r!=null&&r.signature?e.jsx("img",{src:r.signature,alt:"Appraiser's Signature",className:"h-full w-full rounded-md object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No Signature"})})]})]})]})},Er=async(r,s,a,c)=>{try{return await Y({url:`/supervisor/form_b_comments?department_id=${r}&team_id=${s}&year=${a}&staff_id=${c}`,method:"get"})}catch(i){throw console.error("Error fetching information data:",i),i}},Dr=async r=>{try{const s=await Y({url:"/supervisor/form_b_comments",method:"post",data:r});return console.log(s),s}catch(s){throw console.error("Error fetching information data:",s),s}},_r=({submittedEvidence:r})=>{if(!r||r.length===0)return e.jsx("p",{className:"text-gray-500",children:"No submitted evidence available."});const s=async a=>{try{const i=(await Qe(a)).data,d=URL.createObjectURL(i);window.open(d,"_blank")}catch(c){console.error("Error fetching evidence data:",c)}};return e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-800 font-semibold mb-1.5 block",children:"Submitted Evidence:"}),e.jsx("div",{className:"flex flex-col gap-4",children:r.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-md",children:[e.jsx("span",{className:"text-blue-600 underline max-w-[250px] truncate cursor-pointer",onClick:()=>s(a.evidence_id),children:a.evidence_id}),e.jsx("div",{className:"flex-1 text-right",children:e.jsxs("p",{className:"text-gray-500 text-sm",children:[e.jsx("strong",{children:"Created:"})," ",new Date(a.created_at).toLocaleDateString()]})})]},a.id))})]})},Cr=()=>{var w,u,v,S,D,M,H,P,q,B;const{id:r}=W(),s=Ee(),[a,c]=o.useState(),[i,d]=o.useState(!0),[x,f]=o.useState(null),[h,g]=o.useState([]),[b,N]=o.useState(""),[T,E]=o.useState(!1),p=async()=>{try{const F=localStorage.getItem("selectedDepartmentID")||"",z=localStorage.getItem("selectedTeamID"),re=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),K=await Er(F,z?Number(z):null,re,String(r));if(K&&K.data)c(K.data);else throw new Error("Invalid response data")}catch(F){console.error("Error fetching data:",F),f("Failed to load data. Please try again.")}finally{d(!1)}};o.useEffect(()=>{p()},[]);const[n,t]=o.useState({declaration:null,date:null,signature:null,flag:0}),l=o.useRef(null),m=async()=>{var F;if(!b.trim()){E(!0),(F=l.current)==null||F.scrollIntoView({behavior:"smooth",block:"center"}),C.push(e.jsx(I,{title:"Error",type:"danger",children:"Appraisers 's Comments is reuired"}),{placement:"top-center"});return}try{const z=n.date instanceof Date?n.date.toISOString().split("T")[0]:null,re={department_id:localStorage.getItem("selectedDepartmentID")||"",team_id:localStorage.getItem("selectedTeamID"),year:localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),evidence_ids:h,comment:b,date:z,signature:n.signature,declaration:n.declaration,flag:n.flag,staff_id:String(r)};(await Dr(re)).status===200?C.push(e.jsx(I,{title:"Success",type:"success",children:"Data submitted successfully!"}),{placement:"top-center"}):C.push(e.jsx(I,{title:"Error",type:"danger",children:"Unexpected response from the server. Please try again."}),{placement:"top-center"})}catch(z){console.error("Error submitting data:",z),C.push(e.jsx(I,{title:"Error",type:"danger",children:"Failed to submit data. Please check your connection and try again."}),{placement:"top-center"})}},j=()=>{s(-1)},y=()=>{s(`/form/supervisor/annual-review/${r}`)};return i?e.jsx("div",{children:"Loading..."}):x?e.jsx("div",{className:"text-red-500",children:x}):e.jsxs("div",{className:"mt-4  mx-auto w-full ",children:[e.jsx(yr,{}),e.jsxs("div",{className:"bg-white p-4",children:[e.jsx("div",{className:"mt-4",children:e.jsx(_r,{submittedEvidence:((u=(w=a==null?void 0:a.comments)==null?void 0:w.staff)==null?void 0:u.evidence)||[]})}),e.jsx("div",{className:"mt-4",children:e.jsx(Nr,{evidenceList:(a==null?void 0:a.evidence_list)||[],onChange:g})}),e.jsx("div",{className:"mt-4",children:e.jsx(vr,{commentInputRef:l,comments:{staff:((v=a==null?void 0:a.comments)==null?void 0:v.staff)||{comment:""},supervisor:((S=a==null?void 0:a.comments)==null?void 0:S.supervisor)||{comment:""},officer:((D=a==null?void 0:a.comments)==null?void 0:D.officer)||{comment:""}},showValidationError:T,onAppraisersCommentChange:N})}),e.jsx("div",{className:"mt-4",children:e.jsx(wr,{Staff:(M=a==null?void 0:a.comments)==null?void 0:M.staff})}),e.jsx("div",{className:"mt-4",children:e.jsx(Sr,{Supervisor:(H=a==null?void 0:a.comments)==null?void 0:H.supervisor,onChange:F=>{t(F)},officerDeclaration:(q=(P=a==null?void 0:a.comments)==null?void 0:P.officer)==null?void 0:q.declaration})}),e.jsx("div",{className:"mt-4",children:e.jsx(Tr,{officer:(B=a==null?void 0:a.comments)==null?void 0:B.officer})})]}),e.jsx(De,{back:"Back",handleBack:j,save:"Save",handleSave:m,next:"Next",handleNext:y})]})},Br=()=>{const{id:r}=W(),s=U(u=>u.quaterTab.selectedQuarter),[a,c]=o.useState(),[i,d]=o.useState(!0),[x,f]=o.useState(null),[h,g]=o.useState(!1),b=()=>{g(!0),N()},N=async()=>{try{const u=localStorage.getItem("selectedDepartmentID")||"",v=localStorage.getItem("selectedTeamID"),S=localStorage.getItem("selectedYear")?Number(localStorage.getItem("selectedYear")):new Date().getFullYear(),D=await We(u,v?Number(v):null,S,r,s);if(D&&D.data)c(D.data);else throw new Error("Invalid response data")}catch(u){console.error("Error fetching data:",u),f("Failed to load data. Please try again.")}finally{d(!1)}};if(o.useEffect(()=>{N()},[]),i)return e.jsx("div",{children:"Loading..."});if(x)return e.jsx("div",{className:"text-red-500",children:x});const{department:T,team:E,supervisor:p,officer:n,staff:t,progress:l,employee_task:m,competencies:j,operation_and_process:y,others:w}=a||{};return e.jsxs("div",{children:[e.jsx(_e,{department:T,team:E,progress:l,title:"PERFORMANCE APPRAISAL"}),t&&p&&n&&e.jsx(Ce,{staff:t,supervisor:p,officer:n}),e.jsx(jr,{}),e.jsxs("div",{className:"mt-4",children:[e.jsx(Le,{}),e.jsx(er,{employee_task:m,onSubmitSuccess:b})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(ar,{}),e.jsx(cr,{competencies:j})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(dr,{}),e.jsx(xr,{operation_and_process:y})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(pr,{}),e.jsx(br,{assesment:w.strengths,improvement:w.improvement})]}),e.jsx(Cr,{})]})};export{Br as default};
